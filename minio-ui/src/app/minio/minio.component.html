<div class="upload-container">
  <div class="upload-card">
    <div class="upload-header">
      <div class="icon-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
        </svg>
      </div>
      <h1>Subir Archivo a MinIO</h1>
      <p>Arrastra y suelta tu archivo aquí o haz clic para seleccionar</p>
    </div>

    <div
      class="drop-zone"
      [class.drag-over]="isDragging()"
      [class.has-file]="selectedFile()"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
      (click)="fileInput.click()">

      @if (!selectedFile()) {
        <div class="drop-zone-content">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <p>Haz clic o arrastra un archivo</p>
          <span>Cualquier tipo de archivo hasta 10MB</span>
        </div>
      }

      @if (selectedFile()) {
        <div class="file-preview">
          @if (imagePreview()) {
            <img [src]="imagePreview()" alt="Preview">
          }
          <div class="file-info">
            <p class="file-name">{{ selectedFile()?.name }}</p>
            <p class="file-size">{{ formatFileSize(selectedFile()?.size || 0)}}</p>
          </div>
          @if (!uploadSuccess()) {
            <button class="remove-btn" (click)="removeFile($event)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          }
        </div>
      }

      <!-- Handle images -->
      <input
        #fileInput
        type="file"
        (change)="onFileSelected($event)"
        style="display: none;">
    </div>

    @if (selectedFile() && !uploadSuccess()) {
      <button class="upload-btn" (click)="uploadFile()">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
        </svg>
        Subir Archivo
      </button>
    }

    @if (uploadSuccess()) {
      <div class="success-message">
        <div class="success-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <h3>¡Éxito!</h3>
        <p>El archivo se ha subido correctamente a MinIO</p>
        <button class="new-upload-btn" (click)="resetUpload()">
          Subir otro archivo
        </button>
      </div>
    }

    @if (errorMessage()) {
      <div class="error-message">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <p>{{ errorMessage() }}</p>
      </div>
    }
  </div>
</div>
